---

# packages/archlinux/pacman

- name: upgrade pacman packages
  become: yes
  pacman: upgrade=yes

# packages/acrhlinux/aur_pacaur

- name: upgrade pacaur packages
  pacaur: upgrade=yes

# packages/darwin/brew

- name: upgrade homebrew packages
  homebrew: upgrade_all=yes

# services/archlinux/docker

- name: restart docker systemd service
  systemd:
    name: "docker"
    user: yes
    daemon_reload: yes
    state: restarted

# services/archlinux/mpd

- name: restart mpd systemd service
  systemd:
    name: "mpd"
    user: yes
    daemon_reload: yes
    state: restarted

# services/archlinux/nfs

- name: restart nfs-server systemd service
  become: yes
  systemd:
    name: "nfs-server"
    daemon_reload: yes
    state: restarted

# services/archlinux/redshift

- name: restart redshift systemd service
  systemd:
    name: "redshift"
    user: yes
    daemon_reload: yes
    state: restarted

# services/archlinux/syncthing

- name: restart syncthing systemd service
  become: yes
  systemd:
    name: "syncthing@{{ansible_user_id}}"
    daemon_reload: yes
    state: restarted

# services/archlinux/unbound

- name: restart unbound systemd service
  become: yes
  systemd:
    name: "unbound"
    daemon_reload: yes
    state: restarted

# services/darwin/env

- name: unload environment launchd service
  command: launchctl unload ~/Library/LaunchAgents/th.in.grid.env.plist
  ignore_errors: yes

- name: load environment launchd service
  command: launchctl load ~/Library/LaunchAgents/th.in.grid.env.plist
  ignore_errors: yes

# services/darwin/syncthing

- name: unload syncthing launchd service
  command: launchctl unload ~/Library/LaunchAgents/net.syncthing.syncthing.plist
  ignore_errors: yes

- name: load syncthing launchd service
  command: launchctl load ~/Library/LaunchAgents/net.syncthing.syncthing.plist
  ignore_errors: yes

# services/darwin/unbound

- name: unload unbound launchd service
  command: launchctl unload ~/Library/LaunchAgents/net.unbound.unbound.plist
  ignore_errors: yes

- name: load unbound launchd service
  command: launchctl load ~/Library/LaunchAgents/net.unbound.unbound.plist
  ignore_errors: yes

# custom/python

- name: update default python
  command: ~/.pyenv/bin/pyenv global {{python2_version}} {{python3_version}}

- name: update pyenv shims
  command: ~/.pyenv/bin/pyenv rehash

# custom/ruby

- name: update default ruby
  command: ~/.rbenv/bin/rbenv global {{ruby_version}}

- name: update rbenv shims
  command: ~/.rbenv/bin/rbenv rehash
